# Jefit Clone - Workout Tracking Application

## Overview
A comprehensive fitness tracking application inspired by Jefit. The project aims to provide users with tools for managing their fitness journey, including an extensive exercise library, a flexible workout routine builder, real-time active workout logging, detailed progress tracking, and body statistics monitoring. The business vision is to deliver a user-friendly and robust platform that empowers individuals to achieve their fitness goals.

## User Preferences
I prefer detailed explanations and iterative development. Please ask before making major changes. Do not make changes to the folder `Z` and do not make changes to the file `Y`.

## System Architecture

### UI/UX Decisions
The application features a mobile-first design with responsive breakpoints. It employs a modern Glassmorphism aesthetic, characterized by frosted glass surfaces, semi-transparent backgrounds, and backdrop-blur effects. The color scheme utilizes blue and orange gradients, providing a vibrant yet clean interface. Typography is primarily Inter, with JetBrains Mono used for statistical and numerical displays. Dark mode is supported with a `ThemeProvider` and `ThemeToggle` component, ensuring consistent visual appeal across themes. Navigation is handled by a fixed bottom navigation bar with glass styling.

### Technical Implementations
- **Frontend**: React, TypeScript, Tailwind CSS, Shadcn UI, Recharts for data visualization, Wouter for routing, TanStack Query for state management, and React Hook Form with Zod for form validation.
- **Backend**: Express.js and Node.js for API services.
- **Database**: PostgreSQL, managed with Drizzle ORM.
- **Data Models**: Shared Zod schemas define data structures for exercises, workout routines, logs, progress records, and body stats, ensuring consistency between frontend and backend.

### Feature Specifications
-   **Exercise Library**: Contains 110 exercises categorized by muscle group, with search, filtering, equipment badges, and descriptions. Features a two-tab interface: "All Exercises" (default) shows all 110+ exercises, while "Custom Exercises" filters to show only user-created exercises. **Exercise Images**: All 110 seeded exercises include copyright-free stock images automatically assigned based on equipment type (barbell, dumbbell, bodyweight, cable, machine). Exercises display their images on cards, falling back to a dumbbell icon if no image URL is present. Users can create custom exercises from the exercise library page or directly during routine building. Custom exercises can be edited by clicking the pencil icon on their cards, while seeded exercises cannot be modified. The system uses an `isCustom` boolean field to distinguish between user-created and seeded exercises, with server-side validation preventing unauthorized modifications to seeded exercises (returns 403 Forbidden). Each exercise card features an "Add to Routine" button that opens a comprehensive dialog for adding exercises directly to existing workout routines. Tab filtering integrates seamlessly with search and muscle group filters. **Exercise Deletion**: All exercises (custom and seeded) can be deleted via a trash icon button on each exercise card. Deletion requires confirmation via AlertDialog. The backend validates that the exercise is not currently used in any workout routines or logs before allowing deletion, returning a 409 Conflict error with descriptive message if the exercise is in use. Successfully deleted exercises are immediately removed from the UI with cache invalidation.
-   **Custom Exercise Creation**: Users can create custom exercises with name, main muscle group (required), other muscle groups (optional multi-select), equipment type, optional description, and optional image upload. Available both from the exercise library and inline during routine building via a "Custom" button. **Image Upload**: Users can upload custom exercise images (JPEG, PNG, GIF, WebP) up to 5MB. The system validates file signatures using the file-type library (not just MIME types) to prevent malicious uploads. Upload interface includes image preview and remove functionality. Failed uploads are automatically cleaned up. The "Other Muscle Groups" field allows selecting multiple additional muscle groups beyond the primary one, displayed in a 2-column grid with glass-surface styling. Features explicit validation for required fields (including imageUrl type validation: string or null only), optimistic cache updates for immediate availability, and auto-selection after creation. Includes safeguards against duplicate submissions and displays exercise names correctly without "Unknown" placeholders. All muscle group values are normalized to lowercase for consistent data storage and edit dialog population. **Image Editing**: Custom exercises can be edited to upload new images, replace existing images, or remove images entirely. When images are replaced or removed, the old image files are automatically deleted from disk after successful database updates, preventing orphaned files. Image removal sets imageUrl to null in the database.
-   **Add to Routine from Library**: Users can add exercises directly from the exercise library to existing workout routines via an "Add to Routine" button on each exercise card. The feature includes a comprehensive dialog that allows users to: select which routine to add the exercise to, choose multiple days (Monday-Sunday or "Any Day"), configure the number of sets (1-10), and customize reps and rest periods for each individual set. The backend validates all inputs including exercise existence, valid day names, positive reps, and rest periods within bounds (30-300 seconds). Changes are immediately reflected in the routine builder with proper cache invalidation.
-   **Workout Routines**: Allows users to create custom routines using a day-by-day builder workflow with tabs for each day (Monday-Sunday + "Any Day"). Users can assign exercises to specific days, configure sets, reps, and individual rest periods (30-300 seconds) per set. Custom day titles are supported. Routines can be deleted with a confirmation dialog. Exercises can be added to routines either during routine creation or directly from the exercise library. **Weight Tracking**: Each set in a routine can store an optional weight value. Weight inputs are conditionally displayed based on exercise equipment type: non-bodyweight exercises (barbell, dumbbell, machine, cable) show weight inputs in both the routine builder and "Add to Routine" dialog, while bodyweight exercises (equipment === "bodyweight") hide weight inputs for a cleaner UI. Weight values are stored in the setsConfig array alongside reps and rest periods.
-   **Active Workout Tracking**: Provides a real-time tracker for workout sessions, logging sets with weight and reps. Features a custom and editable rest timer with persistent save option: users can edit rest periods during countdown, and when finished editing (blur or Enter key), a dialog appears asking whether to save the change permanently to the routine or apply it only for the current session. The system deep-clones routine data to preserve all exercise metadata when saving, and provides clear feedback when attempting to save rest periods for dynamically added sets (which are session-specific). Supports dynamic set addition during workouts via "+ Add Set" button with persistent save option: when adding a set, a dialog asks whether to save the change permanently to the routine (updating both setsConfig and legacy sets field for backward compatibility) or apply it only for the current session. Displays an estimated 1RM (One-Rep Max) dynamically during workouts using the Epley formula. Uses smart auto-expansion: the first exercise is expanded by default when starting a workout, and each subsequent exercise automatically expands when the last set of the previous exercise is completed, creating a smooth, focused workout flow. **Weight Tracking**: Weight values from the routine's setsConfig are pre-populated during active workouts. The UI conditionally displays weight inputs: non-bodyweight exercises show a weight column in a 12-column grid layout (Set: 2 cols, Weight: 4 cols, Reps: 3 cols, Done: 3 cols), while bodyweight exercises use an 8-column grid with no weight column (Set: 2 cols, Reps: 3 cols, Done: 3 cols). Backend validation requires only positive reps for completed sets, allowing bodyweight exercises to have weight = 0 or undefined. Total volume calculations correctly filter for sets with weight > 0.
-   **Progress Dashboard**: Offers an overview of workout statistics (total workouts, volume lifted) and volume progression charts. Includes an "Exercises" tab for tracking Personal Records (PRs) such as best weight, reps, and volume, along with the dates achieved. Displays weight progression charts for the last 10 workouts.
-   **Body Stats Tracking**: Enables recording and visualizing weight and body fat percentage over time with historical data.

### System Design Choices
-   **Modular Project Structure**: Separates frontend (`client/`), backend (`server/`), and shared schemas (`shared/`) for clear organization.
-   **API Endpoints**: Comprehensive RESTful API for all major features (exercises, workout routines, logs, progress, body stats).
-   **Data Validation**: Implements both client-side and server-side validation (e.g., positive numbers for weight/reps, server-side recomputation of total volume) to ensure data integrity.
-   **Idempotent Seeding**: A database seed script ensures a consistent initial state for development and testing.

## External Dependencies
-   **PostgreSQL**: Primary database for data persistence.
-   **Shadcn UI**: UI component library for consistent design.
-   **Recharts**: Library for rendering charts and graphs in the progress dashboard.
-   **TanStack Query**: For server state management and caching.
-   **Wouter**: Client-side routing.
-   **React Hook Form with Zod**: For form management and validation.